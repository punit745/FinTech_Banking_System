<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="FinTech Banking System ‚Äî A professional-grade banking application.">
    <title>FinTech Banking System</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
</head>

<body>
    <div class="toast-container" id="toastContainer"></div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CONFIRMATION MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal-card">
            <h3 id="confirmTitle">Confirm Action</h3>
            <p class="modal-subtitle" id="confirmSubtitle">Review the details below.</p>
            <div class="confirm-details" id="confirmDetails"></div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('confirmModal')">Cancel</button>
                <button class="btn btn-primary" id="confirmActionBtn" onclick="executePendingAction()">
                    <span class="btn-spinner"></span><span class="btn-text">Confirm</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê RECEIPT MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="modal-overlay" id="receiptModal">
        <div class="modal-card receipt-card">
            <div class="receipt-check">‚úì</div>
            <div class="receipt-amount" id="receiptAmount">$0.00</div>
            <div class="receipt-label">Transaction Successful</div>
            <div class="receipt-details" id="receiptDetails"></div>
            <button class="btn btn-primary" style="width:100%;" onclick="closeModal('receiptModal')">Done</button>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê AUTH PAGE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="authPage" class="auth-page">
        <div class="auth-container">
            <div class="auth-card">
                <div class="auth-brand">
                    <div class="logo-lg">üè¶</div>
                    <h1>FinTech Banking</h1>
                    <p>Secure. Intelligent. Modern.</p>
                </div>
                <div class="auth-tabs auth-tabs-3">
                    <button type="button" class="auth-tab active" onclick="switchAuthTab('login')">üë§ Customer</button>
                    <button type="button" class="auth-tab" onclick="switchAuthTab('employee')">üè¢ Employee</button>
                    <button type="button" class="auth-tab" onclick="switchAuthTab('register')">üìù Register</button>
                </div>
                <!-- Customer Login -->
                <form id="loginForm" class="auth-form active" onsubmit="handleLogin(event)">
                    <div class="auth-role-label">Customer Sign In</div>
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="loginUsername" class="form-control" placeholder="Enter username"
                            required>
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="loginPassword" class="form-control" placeholder="Enter password"
                            required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-lg" style="width:100%;margin-top:8px;"
                        id="loginBtn">
                        <span class="btn-spinner"></span><span class="btn-text">Sign In</span>
                    </button>
                </form>
                <!-- Employee Login -->
                <form id="employeeLoginForm" class="auth-form" onsubmit="handleEmployeeLogin(event)">
                    <div class="auth-role-label employee-label">Employee Sign In</div>
                    <div class="form-group">
                        <label>Employee ID</label>
                        <input type="text" id="empId" class="form-control" placeholder="e.g. EMP001" required
                            minlength="3">
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="empPassword" class="form-control" placeholder="Enter password"
                            required>
                    </div>
                    <button type="submit" class="btn btn-employee btn-lg" style="width:100%;margin-top:8px;"
                        id="empLoginBtn">
                        <span class="btn-spinner"></span><span class="btn-text">Employee Sign In</span>
                    </button>
                </form>
                <!-- Register -->
                <form id="registerForm" class="auth-form" onsubmit="handleRegister(event)">
                    <div class="auth-role-label">New Customer Registration</div>
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="regUsername" class="form-control" placeholder="Choose username" required
                            minlength="3">
                    </div>
                    <div class="form-group">
                        <label>Full Name</label>
                        <input type="text" id="regFullName" class="form-control" placeholder="Your full name" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="regEmail" class="form-control" placeholder="you@example.com" required>
                    </div>
                    <div class="form-group">
                        <label>Phone Number</label>
                        <input type="tel" id="regPhone" class="form-control" placeholder="+91 XXXXX XXXXX">
                    </div>
                    <div class="form-group">
                        <label>Date of Birth</label>
                        <input type="date" id="regDOB" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="regPassword" class="form-control" placeholder="Min 6 characters"
                            required minlength="6">
                    </div>
                    <button type="submit" class="btn btn-primary btn-lg" style="width:100%;margin-top:8px;"
                        id="registerBtn">
                        <span class="btn-spinner"></span><span class="btn-text">Create Account</span>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MAIN APP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="appPage" class="app-container" style="display:none;">
        <button class="mobile-menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        <!-- ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-brand">
                <div class="logo">üè¶</div>
                <div>
                    <h1>FinTech Banking</h1>
                    <div class="version">v3.0</div>
                </div>
                <button class="theme-toggle-btn" id="themeToggleBtn" onclick="toggleTheme()"
                    title="Toggle theme">üåô</button>
            </div>
            <nav class="sidebar-nav">
                <!-- Customer Navigation -->
                <div class="customer-nav">
                    <div class="nav-label">Main</div>
                    <a class="nav-item active" data-page="dashboard" onclick="navigateTo('dashboard')"><span
                            class="icon">üìä</span> Dashboard</a>
                    <a class="nav-item" data-page="accounts" onclick="navigateTo('accounts')"><span
                            class="icon">üí∞</span>
                        My Accounts</a>

                    <div class="nav-label">Banking</div>
                    <a class="nav-item" data-page="transfer" onclick="navigateTo('transfer')"><span
                            class="icon">üîÑ</span>
                        Fund Transfer</a>
                    <a class="nav-item" data-page="transactions" onclick="navigateTo('transactions')"><span
                            class="icon">üí≥</span> Deposit / Withdraw</a>
                    <a class="nav-item" data-page="history" onclick="navigateTo('history')"><span class="icon">üìú</span>
                        History</a>

                    <div class="nav-label">Intelligence</div>
                    <a class="nav-item" data-page="analytics" onclick="navigateTo('analytics')"><span
                            class="icon">ü§ñ</span>
                        AI Insights</a>

                    <div class="nav-label">Settings</div>
                    <a class="nav-item" data-page="profile" onclick="navigateTo('profile')"><span class="icon">üë§</span>
                        My
                        Profile</a>
                </div>

                <!-- Admin Navigation (shown only for employees) -->
                <div class="admin-nav" style="display:none;">
                    <div class="nav-label">Admin Panel</div>
                    <a class="nav-item active" data-page="admin-dashboard" onclick="navigateTo('admin-dashboard')"><span
                            class="icon">üè†</span> Admin Dashboard</a>
                    <a class="nav-item" data-page="admin-users" onclick="navigateTo('admin-users')"><span
                            class="icon">üë•</span> Users Management</a>
                    <a class="nav-item" data-page="admin-accounts" onclick="navigateTo('admin-accounts')"><span
                            class="icon">üè¶</span> Accounts Management</a>
                    <a class="nav-item" data-page="admin-transactions" onclick="navigateTo('admin-transactions')"><span
                            class="icon">üí∏</span> All Transactions</a>
                    <a class="nav-item" data-page="admin-audit" onclick="navigateTo('admin-audit')"><span
                            class="icon">üìã</span> Audit Logs</a>
                </div>
            </nav>
            <div class="sidebar-footer">
                <div class="session-timer" id="sessionTimer">
                    <span class="timer-icon">üîí</span><span>Session:</span>
                    <span class="timer-value" id="sessionTimerValue">--:--</span>
                </div>
                <div class="user-card">
                    <div class="user-avatar" id="userAvatarInitials">U</div>
                    <div class="user-info">
                        <div class="name" id="sidebarUserName">User</div>
                        <div class="role" id="sidebarUserRole">customer</div>
                    </div>
                    <button class="btn-logout" onclick="logout()" title="Sign Out">‚èª</button>
                </div>
            </div>
        </aside>

        <!-- ‚îÄ‚îÄ MAIN CONTENT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <main class="main-content">

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PAGE 1: DASHBOARD ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-dashboard" class="page-section active">
                <div class="page-header">
                    <div>
                        <h2 id="dashboardGreeting">Dashboard</h2>
                        <p>Your financial overview at a glance.</p>
                    </div>
                    <div style="position:relative;">
                        <button class="notification-bell" id="notifBell" onclick="toggleNotifications()">üîî<span
                                class="notif-count" id="notifCount"></span></button>
                        <div class="notification-panel" id="notifPanel">
                            <div class="notif-header"><span>Notifications</span><button
                                    onclick="clearNotifications()">Clear all</button></div>
                            <div class="notif-list" id="notifList">
                                <div class="notif-empty">No notifications yet</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="kpi-grid" id="dashboardKPIs">
                    <div class="kpi-card indigo">
                        <div class="kpi-icon">üí∞</div>
                        <div class="kpi-value" id="kpiTotalBalance">‚Çπ0.00</div>
                        <div class="kpi-label">Total Balance</div>
                    </div>
                    <div class="kpi-card cyan">
                        <div class="kpi-icon">üèß</div>
                        <div class="kpi-value" id="kpiAccountCount">0</div>
                        <div class="kpi-label">Accounts</div>
                    </div>
                    <div class="kpi-card emerald">
                        <div class="kpi-icon">üìà</div>
                        <div class="kpi-value" id="kpiTotalIncome">‚Çπ0.00</div>
                        <div class="kpi-label">Total Income</div>
                    </div>
                    <div class="kpi-card rose">
                        <div class="kpi-icon">üìâ</div>
                        <div class="kpi-value" id="kpiTotalExpenses">‚Çπ0.00</div>
                        <div class="kpi-label">Total Expenses</div>
                    </div>
                </div>
                <div class="grid-2" style="margin-top:20px;">
                    <div class="card">
                        <div class="card-header"><span class="card-title">Account Balances</span></div>
                        <div class="chart-container"><canvas id="balanceChart"></canvas></div>
                    </div>
                    <div class="card">
                        <div class="card-header"><span class="card-title">Spending Breakdown</span></div>
                        <div class="chart-container"><canvas id="spendingDoughnut"></canvas></div>
                    </div>
                </div>
                <div class="card" style="margin-top:20px;">
                    <div class="card-header"><span class="card-title">Recent Activity</span></div>
                    <div id="recentActivity">
                        <div class="loading-overlay">
                            <div class="spinner"></div>Loading...
                        </div>
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PAGE 2: MY ACCOUNTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-accounts" class="page-section">
                <div class="page-header">
                    <div>
                        <h2>My Accounts</h2>
                        <p>Open, manage, freeze, or close your bank accounts.</p>
                    </div>
                </div>
                <div style="display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;">
                    <button class="btn btn-primary" onclick="showCreateAccountForm()">Ôºã Open New Account</button>
                    <button class="btn btn-secondary" onclick="loadAccounts()">üîÑ Refresh</button>
                </div>
                <!-- Create Account Form (collapsible) -->
                <div id="createAccountForm" class="card" style="display:none;margin-bottom:20px;">
                    <h3 style="margin-bottom:16px;">Open New Bank Account</h3>
                    <form onsubmit="handleCreateAccount(event)">
                        <div class="grid-2">
                            <div class="form-group"><label>Account Type</label>
                                <select id="newAccountType" class="form-control" required>
                                    <option value="savings">Savings Account</option>
                                    <option value="checking">Checking Account</option>
                                    <option value="wallet">Digital Wallet</option>
                                </select>
                            </div>
                            <div class="form-group"><label>Currency</label>
                                <select id="newAccountCurrency" class="form-control">
                                    <option value="INR" selected>INR ‚Äî Indian Rupee</option>
                                    <option value="USD">USD ‚Äî US Dollar</option>
                                    <option value="EUR">EUR ‚Äî Euro</option>
                                    <option value="GBP">GBP ‚Äî British Pound</option>
                                </select>
                            </div>
                        </div>
                        <div style="display:flex;gap:10px;margin-top:8px;">
                            <button type="submit" class="btn btn-success">Create Account</button>
                            <button type="button" class="btn btn-secondary"
                                onclick="hideCreateAccountForm()">Cancel</button>
                        </div>
                    </form>
                </div>
                <!-- Account list -->
                <div id="accountsList" class="kpi-grid">
                    <div class="loading-overlay">
                        <div class="spinner"></div>Loading accounts...
                    </div>
                </div>
                <!-- Account Detail Panel (shown when clicking an account) -->
                <div id="accountDetailPanel" class="account-detail-panel" style="display:none;margin-top:20px;">
                    <div class="account-detail-header">
                        <h3 id="detailAccountTitle">Account Details</h3>
                        <button class="btn btn-secondary btn-sm" onclick="closeAccountDetail()">‚úï Close</button>
                    </div>
                    <div class="account-detail-info" id="detailInfo"></div>
                    <div class="account-actions" id="detailActions" style="margin-bottom:20px;"></div>
                    <div class="card-header"><span class="card-title">Mini Statement (Last 10)</span></div>
                    <div class="table-container" id="detailStatement">
                        <div class="loading-overlay">
                            <div class="spinner"></div>Loading...
                        </div>
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PAGE 3: FUND TRANSFER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-transfer" class="page-section">
                <div class="page-header">
                    <div>
                        <h2>Fund Transfer</h2>
                        <p>Transfer money between your own accounts or to other accounts.</p>
                    </div>
                </div>
                <div class="grid-2">
                    <!-- Own Accounts Transfer -->
                    <div class="txn-form-card">
                        <h3>üîÑ Transfer Between Own Accounts</h3>
                        <form onsubmit="handleOwnTransfer(event)">
                            <div class="form-group"><label>From Account</label>
                                <select id="ownTransferFrom" class="form-control" required>
                                    <option value="">Select...</option>
                                </select>
                            </div>
                            <div class="form-group"><label>To Account</label>
                                <select id="ownTransferTo" class="form-control" required>
                                    <option value="">Select...</option>
                                </select>
                            </div>
                            <div class="form-group"><label>Amount (‚Çπ)</label>
                                <input type="number" id="ownTransferAmount" class="form-control" placeholder="0.00"
                                    min="0.01" step="0.01" required>
                            </div>
                            <div class="form-group"><label>Description</label>
                                <input type="text" id="ownTransferDesc" class="form-control"
                                    placeholder="e.g. Savings to Checking">
                            </div>
                            <button type="submit" class="btn btn-primary" style="width:100%;"><span
                                    class="btn-spinner"></span><span class="btn-text">Transfer</span></button>
                        </form>
                    </div>
                    <!-- To Other Account -->
                    <div class="txn-form-card">
                        <h3>üì§ Transfer to Other Account</h3>
                        <form onsubmit="handleExternalTransfer(event)">
                            <div class="form-group"><label>From Account</label>
                                <select id="extTransferFrom" class="form-control" required>
                                    <option value="">Select...</option>
                                </select>
                            </div>
                            <div class="form-group"><label>Receiver Account ID</label>
                                <input type="number" id="extTransferTo" class="form-control" placeholder="Account ID"
                                    required>
                            </div>
                            <div class="form-group"><label>Amount (‚Çπ)</label>
                                <input type="number" id="extTransferAmount" class="form-control" placeholder="0.00"
                                    min="0.01" step="0.01" required>
                            </div>
                            <div class="form-group"><label>Description</label>
                                <input type="text" id="extTransferDesc" class="form-control"
                                    placeholder="e.g. Rent Payment">
                            </div>
                            <button type="submit" class="btn btn-primary" style="width:100%;"><span
                                    class="btn-spinner"></span><span class="btn-text">Send Money</span></button>
                        </form>
                    </div>
                </div>
                <!-- Beneficiaries -->
                <div class="card" style="margin-top:20px;">
                    <div class="card-header">
                        <span class="card-title">Saved Beneficiaries</span>
                        <button class="btn btn-secondary btn-sm" onclick="showAddBeneficiaryForm()">Ôºã Add</button>
                    </div>
                    <div id="addBeneficiaryForm" style="display:none;margin-bottom:16px;">
                        <div style="display:flex;gap:10px;align-items:flex-end;flex-wrap:wrap;">
                            <div class="form-group" style="flex:1;min-width:140px;margin-bottom:0;"><label>Name</label>
                                <input type="text" id="beneName" class="form-control" placeholder="Recipient name"
                                    required>
                            </div>
                            <div class="form-group" style="flex:1;min-width:120px;margin-bottom:0;"><label>Account
                                    ID</label>
                                <input type="number" id="beneAccountId" class="form-control" placeholder="ID" required>
                            </div>
                            <button class="btn btn-success btn-sm" onclick="addBeneficiary()">Save</button>
                            <button class="btn btn-secondary btn-sm" onclick="hideAddBeneficiaryForm()">Cancel</button>
                        </div>
                    </div>
                    <div id="beneficiaryList" class="beneficiary-grid"></div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PAGE 4: DEPOSIT / WITHDRAW ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-transactions" class="page-section">
                <div class="page-header">
                    <div>
                        <h2>Deposit & Withdraw</h2>
                        <p>Deposit or withdraw funds from your bank accounts.</p>
                    </div>
                </div>
                <div class="txn-form-grid">
                    <!-- Deposit -->
                    <div class="txn-form-card">
                        <h3>üíµ Deposit Funds</h3>
                        <form onsubmit="handleDeposit(event)">
                            <div class="form-group"><label>Account</label>
                                <select id="depositAccount" class="form-control" required>
                                    <option value="">Select account...</option>
                                </select>
                            </div>
                            <div class="form-group"><label>Amount (‚Çπ)</label>
                                <input type="number" id="depositAmount" class="form-control" placeholder="0.00"
                                    min="0.01" step="0.01" required>
                            </div>
                            <div class="form-group"><label>Description</label>
                                <input type="text" id="depositDesc" class="form-control"
                                    placeholder="e.g. Salary Deposit">
                            </div>
                            <button type="submit" class="btn btn-success" style="width:100%;"><span
                                    class="btn-spinner"></span><span class="btn-text">Deposit Funds</span></button>
                        </form>
                    </div>
                    <!-- Withdraw -->
                    <div class="txn-form-card">
                        <h3>üèß Withdraw Funds</h3>
                        <form onsubmit="handleWithdraw(event)">
                            <div class="form-group"><label>Account</label>
                                <select id="withdrawAccount" class="form-control" required>
                                    <option value="">Select account...</option>
                                </select>
                            </div>
                            <div class="form-group"><label>Amount (‚Çπ)</label>
                                <input type="number" id="withdrawAmount" class="form-control" placeholder="0.00"
                                    min="0.01" step="0.01" required>
                            </div>
                            <div class="form-group"><label>Description</label>
                                <input type="text" id="withdrawDesc" class="form-control"
                                    placeholder="e.g. ATM Withdrawal">
                            </div>
                            <button type="submit" class="btn btn-danger" style="width:100%;"><span
                                    class="btn-spinner"></span><span class="btn-text">Withdraw Funds</span></button>
                        </form>
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PAGE 5: HISTORY ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-history" class="page-section">
                <div class="page-header">
                    <div>
                        <h2>Transaction History</h2>
                        <p>View, search, filter, and export your past transactions.</p>
                    </div>
                </div>
                <div class="card" style="margin-bottom:20px;">
                    <div class="history-toolbar">
                        <div class="search-input-wrap">
                            <span class="search-icon">üîç</span>
                            <input type="text" id="historySearch" class="form-control"
                                placeholder="Search transactions..." oninput="debounceFilterHistory()">
                        </div>
                        <div class="form-group"><label>From</label><input type="date" id="historyDateFrom"
                                class="form-control" onchange="filterHistory()"></div>
                        <div class="form-group"><label>To</label><input type="date" id="historyDateTo"
                                class="form-control" onchange="filterHistory()"></div>
                        <div class="form-group"><label>Type</label>
                            <select id="historyTypeFilter" class="form-control" onchange="filterHistory()">
                                <option value="">All Types</option>
                                <option value="DEPOSIT">Deposits</option>
                                <option value="WITHDRAWAL">Withdrawals</option>
                                <option value="TRANSFER">Transfers</option>
                                <option value="PAYMENT">Payments</option>
                            </select>
                        </div>
                        <button class="btn btn-secondary btn-sm" onclick="exportTransactionsCSV()" title="Export CSV">üì•
                            CSV</button>
                        <button class="btn btn-secondary btn-sm" onclick="loadHistory()">üîÑ Refresh</button>
                    </div>
                </div>
                <div class="card">
                    <div class="table-container" id="historyTable">
                        <div class="loading-overlay">
                            <div class="spinner"></div>Loading...
                        </div>
                    </div>
                    <div class="pagination" id="historyPagination" style="display:none;"></div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PAGE 6: AI INSIGHTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-analytics" class="page-section">
                <div class="page-header">
                    <div>
                        <h2>AI Insights</h2>
                        <p>Fraud detection scores and predictive spending analytics.</p>
                    </div>
                </div>
                <div class="grid-2" style="margin-bottom:20px;">
                    <div class="card prediction-card">
                        <div class="card-header"><span class="card-title">Spending Prediction</span></div>
                        <div class="prediction-value" id="predictedSpending">$0.00</div>
                        <div class="prediction-label">Predicted Next Month</div>
                        <div id="spendingTrend"></div>
                        <div style="margin-top:12px;color:var(--text-muted);font-size:0.82rem;">Avg Monthly: <strong
                                id="avgMonthly">$0.00</strong></div>
                    </div>
                    <div class="card">
                        <div class="card-header"><span class="card-title">Spending Summary</span></div>
                        <div class="kpi-grid" style="margin-top:8px;">
                            <div class="kpi-card emerald">
                                <div class="kpi-value" id="summaryIncome">$0.00</div>
                                <div class="kpi-label">Total Income</div>
                            </div>
                            <div class="kpi-card rose">
                                <div class="kpi-value" id="summaryExpenses">$0.00</div>
                                <div class="kpi-label">Total Expenses</div>
                            </div>
                            <div class="kpi-card cyan">
                                <div class="kpi-value" id="summaryNetFlow">$0.00</div>
                                <div class="kpi-label">Net Flow</div>
                            </div>
                            <div class="kpi-card amber">
                                <div class="kpi-value" id="summaryTxnCount">0</div>
                                <div class="kpi-label">Transactions</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card" style="margin-bottom:20px;">
                    <div class="card-header"><span class="card-title">Monthly Income vs Expenses</span></div>
                    <div class="chart-container"><canvas id="monthlyTrendChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-header"><span class="card-title">AI Risk Scores</span><button
                            class="btn btn-secondary btn-sm" onclick="loadRiskScores()">üîÑ Refresh</button></div>
                    <div class="table-container" id="riskScoresTable">
                        <div class="loading-overlay">
                            <div class="spinner"></div>Loading...
                        </div>
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PAGE 7: MY PROFILE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-profile" class="page-section">
                <div class="page-header">
                    <div>
                        <h2>My Profile</h2>
                        <p>View and manage your personal information.</p>
                    </div>
                </div>
                <div class="profile-header" id="profileHeader">
                    <div class="profile-avatar" id="profileAvatar">U</div>
                    <div class="profile-info">
                        <h2 id="profileName">Loading...</h2>
                        <div class="meta">
                            <span>üìß <span id="profileEmail">‚Äî</span></span>
                            <span>üì± <span id="profilePhone">‚Äî</span></span>
                            <span>üéÇ <span id="profileDOB">‚Äî</span></span>
                            <span id="profileKYC"></span>
                        </div>
                    </div>
                </div>
                <div class="grid-3">
                    <!-- Edit Profile -->
                    <div class="card">
                        <h3 style="margin-bottom:16px;">Update Personal Details</h3>
                        <form onsubmit="handleProfileUpdate(event)">
                            <div class="form-group"><label>Full Name</label><input type="text" id="editFullName"
                                    class="form-control" placeholder="Your full name"></div>
                            <div class="form-group"><label>Email</label><input type="email" id="editEmail"
                                    class="form-control" placeholder="you@example.com"></div>
                            <div class="form-group"><label>Phone Number</label><input type="tel" id="editPhone"
                                    class="form-control" placeholder="+91 XXXXX XXXXX"></div>
                            <button type="submit" class="btn btn-primary" style="width:100%;">Save Changes</button>
                        </form>
                    </div>
                    <!-- Change Password -->
                    <div class="card">
                        <h3 style="margin-bottom:16px;">Change Password</h3>
                        <form onsubmit="handlePasswordChange(event)">
                            <div class="form-group"><label>Current Password</label><input type="password"
                                    id="oldPassword" class="form-control" placeholder="Enter current password" required
                                    minlength="6"></div>
                            <div class="form-group"><label>New Password</label><input type="password" id="newPassword"
                                    class="form-control" placeholder="Enter new password" required minlength="6"></div>
                            <div class="form-group"><label>Confirm New Password</label><input type="password"
                                    id="confirmPassword" class="form-control" placeholder="Confirm new password"
                                    required minlength="6"></div>
                            <button type="submit" class="btn btn-warning" style="width:100%;"><span
                                    class="btn-spinner"></span><span class="btn-text">Change Password</span></button>
                        </form>
                    </div>
                    <!-- Account Info -->
                    <div class="card">
                        <h3 style="margin-bottom:16px;">Account Details</h3>
                        <div style="line-height:2.2;">
                            <div><strong style="color:var(--text-muted);">User ID:</strong> <span
                                    id="profileUserId">‚Äî</span></div>
                            <div><strong style="color:var(--text-muted);">Username:</strong> <span
                                    id="profileUsername">‚Äî</span></div>
                            <div><strong style="color:var(--text-muted);">Role:</strong> <span id="profileRole">‚Äî</span>
                            </div>
                            <div><strong style="color:var(--text-muted);">Status:</strong> <span
                                    id="profileStatus">‚Äî</span></div>
                            <div><strong style="color:var(--text-muted);">Member Since:</strong> <span
                                    id="profileCreated">‚Äî</span></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ADMIN DASHBOARD ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-admin-dashboard" class="page-section">
                <div class="page-header">
                    <h2>Admin Dashboard</h2>
                    <p>System-wide overview & KPIs</p>
                </div>
                <div class="grid-4" id="adminKpiGrid">
                    <div class="stat-card admin-card">
                        <div class="stat-value" id="kpiTotalUsers">‚Äî</div>
                        <div class="stat-label">Total Users</div>
                    </div>
                    <div class="stat-card admin-card">
                        <div class="stat-value" id="kpiActiveUsers">‚Äî</div>
                        <div class="stat-label">Active Users</div>
                    </div>
                    <div class="stat-card admin-card">
                        <div class="stat-value" id="kpiTotalAccounts">‚Äî</div>
                        <div class="stat-label">Total Accounts</div>
                    </div>
                    <div class="stat-card admin-card">
                        <div class="stat-value" id="kpiSystemBalance">‚Äî</div>
                        <div class="stat-label">System Balance</div>
                    </div>
                    <div class="stat-card admin-card">
                        <div class="stat-value" id="kpiTotalTxns">‚Äî</div>
                        <div class="stat-label">Total Transactions</div>
                    </div>
                    <div class="stat-card admin-card accent-warn">
                        <div class="stat-value" id="kpiPendingKyc">‚Äî</div>
                        <div class="stat-label">Pending KYC</div>
                    </div>
                    <div class="stat-card admin-card accent-danger">
                        <div class="stat-value" id="kpiFrozenAcct">‚Äî</div>
                        <div class="stat-label">Frozen Accounts</div>
                    </div>
                    <div class="stat-card admin-card">
                        <div class="stat-value" id="kpiRecent24h">‚Äî</div>
                        <div class="stat-label">Recent (24h)</div>
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ADMIN USERS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-admin-users" class="page-section">
                <div class="page-header">
                    <h2>Users Management</h2>
                    <p>View, search, and manage all registered users</p>
                </div>
                <div class="card" style="margin-bottom:24px;">
                    <div class="admin-toolbar">
                        <input type="text" id="adminUserSearch" class="form-control"
                            placeholder="Search by name, username, or email..." style="max-width:400px;"
                            oninput="debounceAdminUserSearch()">
                        <select id="adminKycFilter" class="form-control" style="max-width:180px;"
                            onchange="loadAdminUsers()">
                            <option value="">All KYC Status</option>
                            <option value="pending">Pending</option>
                            <option value="verified">Verified</option>
                            <option value="rejected">Rejected</option>
                        </select>
                    </div>
                </div>
                <div class="card table-card">
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Username</th>
                                    <th>Full Name</th>
                                    <th>Email</th>
                                    <th>KYC</th>
                                    <th>Accounts</th>
                                    <th>Balance</th>
                                    <th>Active</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminUsersTableBody">
                                <tr>
                                    <td colspan="9" class="text-center">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ADMIN ACCOUNTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-admin-accounts" class="page-section">
                <div class="page-header">
                    <h2>Accounts Management</h2>
                    <p>Oversee all bank accounts</p>
                </div>
                <div class="card" style="margin-bottom:24px;">
                    <div class="admin-toolbar">
                        <input type="text" id="adminAcctSearch" class="form-control"
                            placeholder="Search by account number, username..." style="max-width:400px;"
                            oninput="debounceAdminAcctSearch()">
                        <select id="adminAcctStatusFilter" class="form-control" style="max-width:180px;"
                            onchange="loadAdminAccounts()">
                            <option value="">All Statuses</option>
                            <option value="active">Active</option>
                            <option value="frozen">Frozen</option>
                            <option value="closed">Closed</option>
                        </select>
                    </div>
                </div>
                <div class="card table-card">
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Account #</th>
                                    <th>Type</th>
                                    <th>Owner</th>
                                    <th>Balance</th>
                                    <th>Status</th>
                                    <th>Created</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminAcctTableBody">
                                <tr>
                                    <td colspan="7" class="text-center">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ADMIN TRANSACTIONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-admin-transactions" class="page-section" style="display:none;">
                <div class="page-header">
                    <h2>All Transactions</h2>
                    <p>System-wide transaction ledger</p>
                </div>
                <div class="card" style="margin-bottom:24px;">
                    <div class="admin-toolbar">
                        <input type="text" id="adminTxnSearch" class="form-control"
                            placeholder="Search by reference, user, account..." style="max-width:400px;"
                            oninput="debounceAdminTxnSearch()">
                        <select id="adminTxnTypeFilter" class="form-control" style="max-width:180px;"
                            onchange="loadAdminTransactions()">
                            <option value="">All Types</option>
                            <option value="DEPOSIT">Deposit</option>
                            <option value="WITHDRAWAL">Withdrawal</option>
                            <option value="TRANSFER">Transfer</option>
                        </select>
                    </div>
                </div>
                <div class="card table-card">
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Ref</th>
                                    <th>Date</th>
                                    <th>Type</th>
                                    <th>User</th>
                                    <th>Account</th>
                                    <th>Amount</th>
                                    <th>Balance After</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="adminTxnTableBody">
                                <tr>
                                    <td colspan="8" class="text-center">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ADMIN AUDIT LOGS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="page-admin-audit" class="page-section" style="display:none;">
                <div class="page-header">
                    <h2>Audit Logs</h2>
                    <p>System audit trail</p>
                </div>
                <div class="card table-card">
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Entity</th>
                                    <th>Action</th>
                                    <th>Old Value</th>
                                    <th>New Value</th>
                                    <th>By</th>
                                    <th>IP</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody id="adminAuditTableBody">
                                <tr>
                                    <td colspan="8" class="text-center">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

        </main>
    </div>
    <script src="/static/app.js"></script>
</body>

</html>